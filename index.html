<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二次元卡通人物决斗</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    
    <!-- 自定义Tailwind配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        hero: '#4F46E5', // 左侧英雄色(深紫蓝)
                        heroLight: '#818CF8', // 左侧亮色
                        heroDark: '#3730A3', // 左侧暗色
                        villain: '#DC2626', // 右侧反派色(深红)
                        villainLight: '#FCA5A5', // 右侧亮色
                        villainDark: '#991B1B', // 右侧暗色
                        arena: '#0F172A', // 竞技场背景色(深蓝黑)
                    },
                    animation: {
                        'punch-left': 'punchLeft 0.4s ease-in-out',
                        'punch-right': 'punchRight 0.4s ease-in-out',
                        'hurt': 'hurt 0.3s ease-in-out',
                        'victory': 'victory 1.2s infinite alternate',
                        'cry': 'cry 1s infinite alternate',
                        'fade-out': 'fadeOut 1s forwards',
                        'fade-in': 'fadeIn 1s forwards',
                        'ko': 'ko 1.2s forwards',
                        'hair-sway': 'hairSway 3s ease-in-out infinite alternate',
                        'shine': 'shine 2s ease-in-out infinite alternate',
                        'breath': 'breath 3s ease-in-out infinite alternate'
                    },
                    keyframes: {
                        punchLeft: {
                            '0%': { transform: 'translateX(0)' },
                            '50%': { transform: 'translateX(60px)' },
                            '100%': { transform: 'translateX(0)' }
                        },
                        punchRight: {
                            '0%': { transform: 'translateX(0)' },
                            '50%': { transform: 'translateX(-60px)' },
                            '100%': { transform: 'translateX(0)' }
                        },
                        hurt: {
                            '0%': { opacity: 1, transform: 'translateX(0)' },
                            '50%': { opacity: 0.4, transform: 'translateX(25px) rotate(8deg) scale(0.95)' },
                            '100%': { opacity: 1, transform: 'translateX(0)' }
                        },
                        victory: {
                            '0%': { transform: 'scale(1) rotate(0deg) translateY(0)' },
                            '50%': { transform: 'scale(1.2) rotate(5deg) translateY(-15px)' },
                            '100%': { transform: 'scale(1) rotate(-5deg) translateY(0)' }
                        },
                        cry: {
                            '0%': { transform: 'scale(1) translateY(0)' },
                            '100%': { transform: 'scale(0.95) translateY(10px)' }
                        },
                        fadeOut: {
                            '0%': { opacity: 1 },
                            '100%': { opacity: 0, display: 'none' }
                        },
                        fadeIn: {
                            '0%': { opacity: 0, display: 'block' },
                            '100%': { opacity: 1 }
                        },
                        ko: {
                            '0%': { transform: 'translateY(0) rotate(0deg) scale(1)' },
                            '50%': { transform: 'translateY(50px) rotate(45deg) scale(0.9)' },
                            '100%': { transform: 'translateY(200px) rotate(90deg) scale(0.85)' }
                        },
                        hairSway: {
                            '0%': { transform: 'translateX(-50%) rotate(-2deg)' },
                            '100%': { transform: 'translateX(-50%) rotate(2deg)' }
                        },
                        shine: {
                            '0%': { boxShadow: '0 0 10px rgba(255,255,255,0.3)' },
                            '100%': { boxShadow: '0 0 20px rgba(255,255,255,0.6)' }
                        },
                        breath: {
                            '0%': { transform: 'translateX(-50%) scale(1)' },
                            '50%': { transform: 'translateX(-50%) scale(1.05)' },
                            '100%': { transform: 'translateX(-50%) scale(1)' }
                        }
                    }
                }
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .character-shadow {
                filter: drop-shadow(0 15px 10px rgba(0, 0, 0, 0.3));
            }
            .name-tag {
                text-shadow: 0 3px 6px rgba(0, 0, 0, 0.4);
                font-family: 'Arial Rounded MT Bold', 'Helvetica Rounded', sans-serif;
            }
            .arena-bg {
                background-image: linear-gradient(135deg, #0F172A 0%, #1E293B 100%);
                background-size: 400% 400%;
                animation: gradient 15s ease infinite;
            }
            @keyframes gradient {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
            .health-bar {
                transition: width 0.5s ease-in-out;
                background-image: linear-gradient(90deg, #22c55e, #4ade80);
            }
            .tear {
                position: absolute;
                width: 10px;
                height: 20px;
                background-color: rgba(147, 197, 253, 0.8);
                border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
                transform: rotate(-45deg);
                animation: fall 2s linear infinite;
                box-shadow: 0 0 5px rgba(59, 130, 246, 0.5);
            }
            @keyframes fall {
                0% {
                    transform: rotate(-45deg) translateY(0);
                    opacity: 1;
                }
                100% {
                    transform: rotate(-45deg) translateY(120px);
                    opacity: 0;
                }
            }
            .hair-strand {
                position: absolute;
                background-color: inherit;
                border-radius: 50% 50% 0 0 / 40% 40% 0 0;
            }
            .eye-shine {
                position: absolute;
                width: 2px;
                height: 2px;
                background-color: white;
                border-radius: 50%;
                z-index: 1;
            }
            .clothes-detail {
                position: absolute;
                background-color: rgba(0,0,0,0.1);
                border-radius: 4px;
            }
            .fight-effect {
                position: absolute;
                width: 30px;
                height: 30px;
                background-color: rgba(251, 191, 36, 0.7);
                border-radius: 50%;
                box-shadow: 0 0 15px rgba(251, 191, 36, 0.8);
                opacity: 0;
                animation: effectPulse 0.5s ease-out forwards;
            }
            @keyframes effectPulse {
                0% { transform: scale(0.5); opacity: 1; }
                100% { transform: scale(1.5); opacity: 0; }
            }
        }
    </style>
</head>
<body class="bg-gray-900 min-h-screen flex items-center justify-center p-4">
    <div class="w-full max-w-5xl h-[650px] bg-white rounded-2xl overflow-hidden shadow-2xl relative">
        <!-- 竞技场背景 -->
        <div class="arena-bg w-full h-full absolute z-0">
            <!-- 装饰元素 - 二次元风格光效 -->
            <div class="absolute top-10 left-10 w-32 h-32 rounded-full bg-blue-500 opacity-10 blur-3xl"></div>
            <div class="absolute bottom-10 right-20 w-48 h-48 rounded-full bg-red-500 opacity-10 blur-3xl"></div>
            <div class="absolute top-1/2 left-1/4 w-24 h-24 rounded-full bg-purple-500 opacity-10 blur-3xl"></div>
            <!-- 地面纹理 -->
            <div class="absolute bottom-0 w-full h-20 bg-gradient-to-t from-gray-800 to-transparent opacity-50"></div>
        </div>
        
        <!-- 战斗提示文本 - 二次元字体风格 -->
        <div id="battle-text" class="absolute top-24 left-1/2 transform -translate-x-1/2 bg-black bg-opacity-80 text-white px-8 py-4 rounded-full text-2xl font-bold z-20 opacity-0 tracking-wide">
            战斗开始！
        </div>
        
        <!-- 左侧角色 - 二次元英雄风格 -->
        <div id="character-left" class="character-shadow absolute bottom-40 left-20 w-52 h-80 z-10 transition-all duration-300">
            <!-- 角色名字 -->
            <div class="name-tag absolute -top-16 left-1/2 transform -translate-x-1/2 bg-hero text-white px-6 py-3 rounded-full font-bold text-xl animate-shine">
                LX
            </div>
            
            <!-- 生命值条 -->
            <div class="absolute -top-8 left-0 w-full h-5 bg-gray-800 rounded-full overflow-hidden border-2 border-gray-600">
                <div id="health-left" class="health-bar h-full w-full"></div>
            </div>
            
            <!-- 角色身体 -->
            <div class="w-full h-full relative">
                <!-- 头发 - 二次元风格发型 -->
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-28 h-32 bg-gray-800 rounded-t-full animate-hair-sway">
                    <!-- 头发细节 -->
                    <div class="hair-strand top-8 left-4 w-6 h-16 rotate-[-30deg]"></div>
                    <div class="hair-strand top-8 right-4 w-6 h-16 rotate-[30deg]"></div>
                    <div class="hair-strand top-4 left-1/2 transform -translate-x-1/2 w-12 h-20"></div>
                </div>
                
                <!-- 头部 -->
                <div class="absolute top-12 left-1/2 transform -translate-x-1/2 w-24 h-28 bg-yellow-200 rounded-full border-3 border-yellow-300"></div>
                
                <!-- 眼睛 - 二次元大眼球 -->
                <div class="absolute top-18 left-1/2 transform -translate-x-1/2 -translate-x-10 w-8 h-8 bg-blue-500 rounded-full border-2 border-blue-700">
                    <div class="absolute top-2 left-2 w-4 h-4 bg-black rounded-full">
                        <div class="eye-shine top-1 left-1"></div>
                    </div>
                </div>
                <div class="absolute top-18 left-1/2 transform -translate-x-1/2 +translate-x-4 w-8 h-8 bg-blue-500 rounded-full border-2 border-blue-700">
                    <div class="absolute top-2 left-2 w-4 h-4 bg-black rounded-full">
                        <div class="eye-shine top-1 left-1"></div>
                    </div>
                </div>
                
                <!-- 眉毛 -->
                <div class="absolute top-16 left-1/2 transform -translate-x-1/2 -translate-x-10 w-8 h-1 bg-gray-800 rounded-full rotate-[-15deg]"></div>
                <div class="absolute top-16 left-1/2 transform -translate-x-1/2 +translate-x-4 w-8 h-1 bg-gray-800 rounded-full rotate-[15deg]"></div>
                
                <!-- 嘴巴 (初始为正常) -->
                <div id="mouth-left" class="absolute top-30 left-1/2 transform -translate-x-1/2 w-10 h-2 bg-gray-800 rounded-full"></div>
                
                <!-- 身体 - 二次元战斗服 -->
                <div class="absolute top-40 left-1/2 transform -translate-x-1/2 w-32 h-40 bg-hero rounded-t-3xl border-4 border-heroDark animate-breath">
                    <!-- 衣服细节 -->
                    <div class="clothes-detail top-8 left-4 w-4 h-16"></div>
                    <div class="clothes-detail top-8 right-4 w-4 h-16"></div>
                    <div class="clothes-detail top-4 left-1/2 transform -translate-x-1/2 w-16 h-2 rounded-full"></div>
                    <!-- 腰带 -->
                    <div class="absolute top-24 left-0 w-full h-4 bg-yellow-400 border-y-2 border-yellow-600"></div>
                </div>
                
                <!-- 手臂 - 带护甲 -->
                <div id="arm-left-left" class="absolute top-44 left-4 w-8 h-24 bg-heroLight rounded-lg border-3 border-heroDark transform origin-top-left">
                    <!-- 护甲细节 -->
                    <div class="absolute top-2 left-0 w-full h-4 bg-heroDark rounded-t-lg"></div>
                </div>
                <div id="arm-right-left" class="absolute top-44 right-4 w-8 h-24 bg-heroLight rounded-lg border-3 border-heroDark transform origin-top-right">
                    <!-- 护甲细节 -->
                    <div class="absolute top-2 left-0 w-full h-4 bg-heroDark rounded-t-lg"></div>
                </div>
                
                <!-- 手 -->
                <div class="absolute top-64 left-2 w-10 h-10 bg-yellow-200 rounded-full border-2 border-yellow-300"></div>
                <div class="absolute top-64 right-2 w-10 h-10 bg-yellow-200 rounded-full border-2 border-yellow-300"></div>
                
                <!-- 腿 - 战斗裤 -->
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 -translate-x-8 w-10 h-32 bg-heroDark rounded-t-lg border-3 border-gray-800">
                    <!-- 腿部细节 -->
                    <div class="absolute top-4 left-0 w-full h-2 bg-heroLight opacity-50 rounded-full"></div>
                </div>
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 +translate-x-2 w-10 h-32 bg-heroDark rounded-t-lg border-3 border-gray-800">
                    <!-- 腿部细节 -->
                    <div class="absolute top-4 left-0 w-full h-2 bg-heroLight opacity-50 rounded-full"></div>
                </div>
                
                <!-- 鞋子 -->
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 -translate-x-8 w-14 h-8 bg-gray-800 rounded-t-lg border-2 border-gray-900"></div>
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 +translate-x-2 w-14 h-8 bg-gray-800 rounded-t-lg border-2 border-gray-900"></div>
            </div>
        </div>
        
        <!-- 右侧角色 - 二次元反派风格 -->
        <div id="character-right" class="character-shadow absolute bottom-40 right-20 w-52 h-80 z-10 transition-all duration-300">
            <!-- 角色名字 -->
            <div class="name-tag absolute -top-16 left-1/2 transform -translate-x-1/2 bg-villain text-white px-6 py-3 rounded-full font-bold text-xl animate-shine">
                YSW
            </div>
            
            <!-- 生命值条 -->
            <div class="absolute -top-8 left-0 w-full h-5 bg-gray-800 rounded-full overflow-hidden border-2 border-gray-600">
                <div id="health-right" class="health-bar h-full w-full"></div>
            </div>
            
            <!-- 角色身体 -->
            <div class="w-full h-full relative">
                <!-- 头发 - 二次元刺猬头 -->
                <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-28 h-32 bg-red-900 rounded-t-full animate-hair-sway">
                    <!-- 头发细节 -->
                    <div class="hair-strand top-2 left-2 w-8 h-20 rotate-[-40deg]"></div>
                    <div class="hair-strand top-2 right-2 w-8 h-20 rotate-[40deg]"></div>
                    <div class="hair-strand top-0 left-1/2 transform -translate-x-1/2 w-10 h-24"></div>
                    <div class="hair-strand top-5 left-1/4 w-6 h-18 rotate-[-15deg]"></div>
                    <div class="hair-strand top-5 right-1/4 w-6 h-18 rotate-[15deg]"></div>
                </div>
                
                <!-- 头部 -->
                <div class="absolute top-12 left-1/2 transform -translate-x-1/2 w-24 h-28 bg-red-100 rounded-full border-3 border-red-200"></div>
                
                <!-- 眼睛 - 锐利的二次元眼 -->
                <div class="absolute top-20 left-1/2 transform -translate-x-1/2 -translate-x-10 w-6 h-6 bg-black rounded-full">
                    <div class="eye-shine top-1 right-1"></div>
                </div>
                <div class="absolute top-20 left-1/2 transform -translate-x-1/2 +translate-x-6 w-6 h-6 bg-black rounded-full">
                    <div class="eye-shine top-1 right-1"></div>
                </div>
                
                <!-- 眉毛 - 愤怒的皱眉 -->
                <div class="absolute top-18 left-1/2 transform -translate-x-1/2 -translate-x-10 w-6 h-1.5 bg-gray-800 rounded-full rotate-[20deg]"></div>
                <div class="absolute top-18 left-1/2 transform -translate-x-1/2 +translate-x-6 w-6 h-1.5 bg-gray-800 rounded-full rotate-[-20deg]"></div>
                
                <!-- 嘴巴 (初始为愤怒状态) -->
                <div id="mouth-right" class="absolute top-32 left-1/2 transform -translate-x-1/2 w-10 h-3 bg-gray-800 rounded-b-full"></div>
                
                <!-- 身体 - 二次元战斗夹克 -->
                <div class="absolute top-40 left-1/2 transform -translate-x-1/2 w-32 h-40 bg-villain rounded-t-3xl border-4 border-villainDark animate-breath">
                    <!-- 夹克细节 -->
                    <div class="clothes-detail top-6 left-2 w-4 h-20"></div>
                    <div class="clothes-detail top-6 right-2 w-4 h-20"></div>
                    <div class="absolute top-0 left-1/2 transform -translate-x-1/2 w-20 h-6 bg-villainDark rounded-b-full"></div>
                    <!-- 拉链 -->
                    <div class="absolute top-6 left-1/2 transform -translate-x-1/2 w-1.5 h-16 bg-gray-700 rounded-full"></div>
                </div>
                
                <!-- 手臂 - 肌肉感 -->
                <div id="arm-left-right" class="absolute top-44 left-4 w-8 h-24 bg-villainLight rounded-lg border-3 border-villainDark transform origin-top-left">
                    <!-- 肌肉细节 -->
                    <div class="absolute top-6 left-0 w-full h-3 bg-villainDark opacity-30 rounded-full"></div>
                </div>
                <div id="arm-right-right" class="absolute top-44 right-4 w-8 h-24 bg-villainLight rounded-lg border-3 border-villainDark transform origin-top-right">
                    <!-- 肌肉细节 -->
                    <div class="absolute top-6 left-0 w-full h-3 bg-villainDark opacity-30 rounded-full"></div>
                </div>
                
                <!-- 手 - 带手套 -->
                <div class="absolute top-64 left-2 w-10 h-10 bg-gray-800 rounded-full border-2 border-gray-900"></div>
                <div class="absolute top-64 right-2 w-10 h-10 bg-gray-800 rounded-full border-2 border-gray-900"></div>
                
                <!-- 腿 - 工装裤 -->
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 -translate-x-8 w-10 h-32 bg-gray-800 rounded-t-lg border-3 border-gray-900">
                    <!-- 口袋细节 -->
                    <div class="absolute top-6 left-1 w-6 h-12 bg-gray-700 rounded-sm"></div>
                </div>
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 +translate-x-2 w-10 h-32 bg-gray-800 rounded-t-lg border-3 border-gray-900">
                    <!-- 口袋细节 -->
                    <div class="absolute top-6 left-1 w-6 h-12 bg-gray-700 rounded-sm"></div>
                </div>
                
                <!-- 鞋子 - 战斗靴 -->
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 -translate-x-8 w-14 h-10 bg-black rounded-t-lg border-2 border-gray-800"></div>
                <div class="absolute bottom-0 left-1/2 transform -translate-x-1/2 +translate-x-2 w-14 h-10 bg-black rounded-t-lg border-2 border-gray-800"></div>
                
                <!-- 眼泪容器 -->
                <div id="tears-container" class="absolute top-0 left-0 w-full h-full pointer-events-none overflow-hidden hidden"></div>
            </div>
        </div>
        
        <!-- 战斗效果容器 -->
        <div id="effects-container" class="absolute inset-0 pointer-events-none z-15"></div>
        
        <!-- 胜利标志 -->
        <div id="victory-sign" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-7xl text-yellow-400 opacity-0 z-20">
            <i class="fa fa-trophy" aria-hidden="true"></i>
        </div>
    </div>

    <script>
        // 获取DOM元素
        const characterLeft = document.getElementById('character-left');
        const characterRight = document.getElementById('character-right');
        const healthLeft = document.getElementById('health-left');
        const healthRight = document.getElementById('health-right');
        const mouthLeft = document.getElementById('mouth-left');
        const mouthRight = document.getElementById('mouth-right');
        const armLeftLeft = document.getElementById('arm-left-left');
        const armRightLeft = document.getElementById('arm-right-left');
        const armLeftRight = document.getElementById('arm-left-right');
        const armRightRight = document.getElementById('arm-right-right');
        const effectsContainer = document.getElementById('effects-container');
        const battleText = document.getElementById('battle-text');
        const victorySign = document.getElementById('victory-sign');
        const tearsContainer = document.getElementById('tears-container');
        
        // 战斗状态变量
        let leftHealth = 100;
        let rightHealth = 100;
        const battleDuration = 6000; // 6秒战斗
        const attackInterval = 1000; // 攻击间隔
        let isFighting = true;
        
        // 显示战斗提示
        function showBattleText(text, duration = 1500) {
            battleText.textContent = text;
            battleText.classList.add('animate-fade-in');
            
            setTimeout(() => {
                battleText.classList.remove('animate-fade-in');
                battleText.classList.add('animate-fade-out');
                
                setTimeout(() => {
                    battleText.classList.remove('animate-fade-out');
                }, 1000);
            }, duration);
        }
        
        // 创建战斗效果
        function createFightEffect(x, y) {
            const effect = document.createElement('div');
            effect.className = 'fight-effect';
            effect.style.left = `${x}px`;
            effect.style.top = `${y}px`;
            effectsContainer.appendChild(effect);
            
            // 移除效果元素
            setTimeout(() => {
                effect.remove();
            }, 500);
        }
        
        // 左侧角色攻击
        function leftAttack() {
            if (!isFighting) return;
            
            // 攻击动画
            characterLeft.classList.add('animate-punch-right');
            armRightLeft.style.transform = 'origin-top-right rotate(-70deg) scale(1.1)';
            
            // 攻击效果
            setTimeout(() => {
                // 命中位置和效果
                const hitX = characterRight.offsetLeft + characterRight.offsetWidth / 2 - 15;
                const hitY = characterRight.offsetTop + characterRight.offsetHeight / 3;
                createFightEffect(hitX, hitY);
                
                // 右侧角色受击动画
                characterRight.classList.add('animate-hurt');
                mouthRight.style.height = '6px';
                mouthRight.style.borderRadius = '0 0 50% 50%';
                mouthRight.style.transform = 'translateX(-50%) scale(1.2)';
                
                // 减少生命值
                rightHealth = Math.max(0, rightHealth - 10);
                healthRight.style.width = `${rightHealth}%`;
                
                // 改变生命值条颜色
                if (rightHealth < 30) {
                    healthRight.style.backgroundImage = 'linear-gradient(90deg, #ef4444, #f87171)';
                }
                
                // 检查是否击败对手
                if (rightHealth <= 0) {
                    endBattle(true);
                    return;
                }
                
                // 重置动画
                setTimeout(() => {
                    characterLeft.classList.remove('animate-punch-right');
                    armRightLeft.style.transform = 'origin-top-right';
                    characterRight.classList.remove('animate-hurt');
                    
                    // 恢复表情
                    setTimeout(() => {
                        mouthRight.style.height = '3px';
                        mouthRight.style.borderRadius = '0 0 50% 50%';
                        mouthRight.style.transform = 'translateX(-50%)';
                    }, 300);
                }, 300);
            }, 300);
        }
        
        // 右侧角色攻击
        function rightAttack() {
            if (!isFighting) return;
            
            // 攻击动画
            characterRight.classList.add('animate-punch-left');
            armLeftRight.style.transform = 'origin-top-left rotate(70deg) scale(1.1)';
            
            // 攻击效果
            setTimeout(() => {
                // 命中位置和效果
                const hitX = characterLeft.offsetLeft + characterLeft.offsetWidth / 2 - 15;
                const hitY = characterLeft.offsetTop + characterLeft.offsetHeight / 3;
                createFightEffect(hitX, hitY);
                
                // 左侧角色受击动画
                characterLeft.classList.add('animate-hurt');
                mouthLeft.style.height = '6px';
                mouthLeft.style.borderRadius = '0 0 50% 50%';
                
                // 减少生命值
                leftHealth = Math.max(0, leftHealth - 8); // 左侧防御更强
                healthLeft.style.width = `${leftHealth}%`;
                
                // 改变生命值条颜色
                if (leftHealth < 30) {
                    healthLeft.style.backgroundImage = 'linear-gradient(90deg, #ef4444, #f87171)';
                }
                
                // 重置动画
                setTimeout(() => {
                    characterRight.classList.remove('animate-punch-left');
                    armLeftRight.style.transform = 'origin-top-left';
                    characterLeft.classList.remove('animate-hurt');
                    
                    // 恢复表情
                    setTimeout(() => {
                        mouthLeft.style.height = '2px';
                        mouthLeft.style.borderRadius = '50%';
                    }, 300);
                }, 300);
            }, 300);
        }
        
        // 创建眼泪效果
        function createTear(position) {
            const tear = document.createElement('div');
            tear.className = 'tear';
            tear.style.left = position === 'left' ? '25px' : '115px';
            tear.style.top = '40px';
            tearsContainer.appendChild(tear);
            
            // 移除眼泪元素
            setTimeout(() => {
                tear.remove();
            }, 2000);
        }
        
        // 开始哭泣动画
        function startCrying() {
            tearsContainer.classList.remove('hidden');
            
            // 定时创建眼泪
            const tearInterval = setInterval(() => {
                createTear('left');
                createTear('right');
            }, 500);
            
            return tearInterval;
        }
        
        // 结束战斗
        function endBattle(leftWins) {
            isFighting = false;
            
            if (leftWins) {
                // 左侧胜利，右侧失败
                showBattleText('LX 胜利！', 3000);
                
                // 右侧角色被击败动画
                characterRight.classList.add('animate-ko');
                mouthRight.style.height = '10px';
                mouthRight.style.borderRadius = '50%';
                mouthRight.style.transform = 'translateX(-50%) rotate(180deg) scale(1.5)';
                
                // 左侧角色庆祝
                setTimeout(() => {
                    characterLeft.classList.add('animate-victory');
                    mouthLeft.style.height = '10px';
                    mouthLeft.style.borderRadius = '0 0 50% 50%';
                    mouthLeft.style.transform = 'translateX(-50%) scaleY(1.8)';
                    
                    // 显示胜利标志
                    victorySign.style.opacity = '1';
                    victorySign.style.animation = 'fadeIn 1s forwards, victory 2s infinite alternate';
                    
                    // 右侧角色开始哭泣
                    const tearInterval = startCrying();
                    
                    // 5秒后可以重新开始
                    setTimeout(() => {
                        clearInterval(tearInterval);
                        resetBattle();
                    }, 5000);
                }, 1000);
            }
        }
        
        // 重置战斗
        function resetBattle() {
            // 重置生命值
            leftHealth = 100;
            rightHealth = 100;
            healthLeft.style.width = '100%';
            healthRight.style.width = '100%';
            healthLeft.style.backgroundImage = 'linear-gradient(90deg, #22c55e, #4ade80)';
            healthRight.style.backgroundImage = 'linear-gradient(90deg, #22c55e, #4ade80)';
            
            // 重置动画和样式
            characterLeft.classList.remove('animate-victory');
            characterRight.classList.remove('animate-ko');
            tearsContainer.classList.add('hidden');
            tearsContainer.innerHTML = '';
            victorySign.style.opacity = '0';
            victorySign.style.animation = '';
            
            // 重置表情
            mouthLeft.style.height = '2px';
            mouthLeft.style.borderRadius = '50%';
            mouthLeft.style.transform = 'translateX(-50%)';
            mouthRight.style.height = '3px';
            mouthRight.style.borderRadius = '0 0 50% 50%';
            mouthRight.style.transform = 'translateX(-50%)';
            
            // 清空效果容器
            effectsContainer.innerHTML = '';
            
            // 重新开始战斗
            setTimeout(startBattle, 1000);
        }
        
        // 开始战斗
        function startBattle() {
            isFighting = true;
            showBattleText('战斗开始！');
            
            // 随机攻击序列
            let attackCount = 0;
            const maxAttacks = battleDuration / attackInterval;
            
            const battleInterval = setInterval(() => {
                if (!isFighting) {
                    clearInterval(battleInterval);
                    return;
                }
                
                attackCount++;
                
                // 交替攻击，左侧稍占优势
                if (attackCount % 2 === 0) {
                    leftAttack();
                    if (attackCount > 3) showBattleText('LX 发动强力攻击！', 1000);
                } else {
                    rightAttack();
                    if (attackCount > 3) showBattleText('YSW 反击！', 1000);
                }
                
                // 如果达到最大攻击次数且还没分出胜负，左侧胜利
                if (attackCount >= maxAttacks) {
                    clearInterval(battleInterval);
                    endBattle(true);
                }
            }, attackInterval);
        }
        
        // 初始化战斗
        window.addEventListener('load', () => {
            setTimeout(startBattle, 1000);
        });
    </script>
</body>
</html>
